___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Thinking Engine",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZEAAAGRCAYAAACkIY5XAAARm0lEQVR4nOzdP2xUV77A8ZMnOq9kV1DCc2pib0kaU4CUV+2k3kh4K1aiiF8ipSSw3UZi1ylWSqoYKVtnUm1BpDVNKJ+BGj8ooTISrnk67zLCAf+Z+fneOefOfD6SZYKYu79NzHzn3L9n0ievN1NKqwkAJrN15k1A1kpPAkDvbP9H6QkA6C8RASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIExEAwkQEgDARASBMRAAIO1N6AOq1tJDS1pcpLf1uvD+/9yql9Tsp7e13PRlQCxHhUDkg29+ktLI82evya1ZvdDUVUBu7szjU6oeTBySLvAboLxEBIExEAAgTEQDCRASAMBEBIExEAAgTEQDCRASAMBEBIExEAAgTEQ61/Silu79M/rrIa4D+cgNGjrR+J6WdJ5PdxXdz2PVUQE1EhGOJAnAcu7MACLMSoTqryykNPm5ve8NfU9rZbW97wFsiQlW2vkzp2pV2t/n1H1P6dpjSxvftbhewO4uK5BVI2wEZ+XyQ0oVz3Wwb5pmIUI1xzwKLEhFon4gAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAEOZ5Ij20tNA8dyN619udJ56tAbRDRHpo+5uUVpbjr1+72ARo/U6bUwHzyO6sHjpNQEa6evgTMF+sROAIq8vNim30/cK53z7YKv/+4sLx27j/+Lf/vP2o+b73qnnu++g79JWIMDcuf/T2TfygHIPVD99+z6E4f7ad/821i8f/88izFyk9fd7Ml7/vPBEX+kFEqEZ+43y5f/Kn+6iNQUpb95pY5KDkYBz1pj5tOVr569158komhyX/u8nf9/ZLTQiH+yB98no7f0AqPQjje/2vdrbzwX/FXzvaxdOGg7t08naHX7e3Epg1D3dTGj5IafirlQpVuC0iPVQyIksLzZt825/g85vj5a/a/6Sd5x18nNLm9e5WOKU8e9HEJK+uBIVCbjs7i4lsfNrNLqCV5ZQ2/9z+dnOU8pvsLF4Xk1drnw9S+p9/pPT0bhPKgwf+YRpEhIlc/qi7bXf5BphDMstGQfnfreY6ovWrpSdiXogIzJi8Uvzhi2Z1sjFodulBV0QEZlRenfz9ehOTW5+JCd0QEZhxiwspff3HtysTaJOIwJzIMRmtTAaXSk/DrBARmDPnz6b0083mALyzuTgtEYE5tXYxpZ1/2MXF6YjInHrp9hkc2MVlVUKUiPTQn/52utfngFz+qq1pmAWjVYljJUzKDRh7aOve7F88x/TlVclPN1P6djibV/jTDSsRqrHawsO2OL3PB83uLdeVMA4RoRqzdoPEPlu76DgJ4xER4FAry81xEitEjiMiwJHy6jCvSISEo4gIcCwh4TgiApxISDiKiABjERIOIyLA2HJItr50+i9viQgwkZXlZkUCSUSY1Pajbrff1eN3PS62XTkkeUUCIsJENn9K6f7j7rY/vNn+G37e3ub1drdJSteuiDMpfZA+eb2dUlorPQj9cuFce1czLy00j29dmcIB27u/tHvfsbxy2hjM79X2o5t57uyWnoRCbosI1dj5R7chuf3PlG792P52c0j+/df2t9sXD3dTWr1RegoKuW13FtUYPuh2+13d+Xj7UfNGOq9y+O0unF8iwtx4+ry7be/N+UO+Ph90d1IEdRMRoBVWI/NJRIBWrCw3J0gwX0QEaM3GwNXs80ZEgNYsLqS0+efSUzBNIgK06toVT0ScJ2dKDzBv1q+Of5Xv1r3uTkuFLt36LKX1O6WnYBpEZIoGl1L64Yvx//zaxZT2Xp3u+omlhZRWP4y/fiTP4apkxpVXI7d+7Pa0auogIlMUeTPPr4lGZPXN3VbbuiXH3V98umR8ViPzwTGRGTb8ut17OuVPly4oY1yOjcwHEZlh58+2v00RYRIbg9IT0DURATqzftV1I7NORIDOLC6kNPi49BR0SUSATtmlNdtEBOjUyrID7LNMRIDOWY3MLhEBOue4yOwSkSnaezWd13A4ZwmVc/5sc/Ers0dEpmhz2Fz1Pa78Z/NratLldSJd7zfv6tNwjtPaxW62PUvGvWcc/eK2J1O2fqfft4LIb5ZbX7b//2Fj0Fzh3KXN6829nLYftbfNHL7hzfa2N8tcqDqbPkifvN7O7w2lB6F9r//V7fbvP25nO6vLv709y88P2r3ZY37zOrhSePainRsD5hXIil00E/nPdTdlnDG3rUQI62IXzu1/Nnd/bVtePY1WOufPdnNLGE6Wg+7xBrPFMRGq0kVAso3vutkukxlcKj0BbRMR5sLefukJSI6LzCQRAaZmccGpvrNGRICpshqZLSICTFUbj2umHiIyw9o6BRfaZHfWbBGRGbbxXUoPW7zeAtrg2prZ4jqRGbazm9Lqjeaq6klvKfLvv3Y1FTTHRdq8cwDliMgcePp8squE3aiQrq0ui8issDuL9zjwSdc8pGp2iAgwdT6ozA4RAabOSmR2iAgwdefPer7IrBAR3uM8fqZh87qftVkgIrxn6XelJ2AeLC6ktP2NswH7TkSAYoSk/0QEKGplOaXNP5eegigRAYq7diWlW5+VnoIIEQGq8PUfnbHVRyLCeya5RUrbuto37rqEfnDGVv+ICO8pGZGtL9sPSd7e8Ga726QbowPtot8fbsBIVf5wKaWnd5s7ELclf7JddPZPbyy+if7lrzwbvw9EhOrkN5G1i6WnoKSV5WZVOvhL6Uk4id1ZQJXyqnTzeukpOImI8J69V6UngMbnA2ds1U5EeE+bxyPgtH74whlbNRMRoHrO2KqXiHCoZy9KTwBvjc7Yco+t+ogIhyp5rQgcZmU5peHXpafgXSLCoUSEGq1dbE79pR4iwqFEhFpdu+KMrZqICIfaeVJ6AjjaD1+kdPmj0lOQRISjWIlQu+FNp/7WQEQ4lGtFqN3iQjc37GQyIsKR7j8uPQEcb2W5uYaEckSEIzkuQh+MbtZIGSLCkbYflZ4AxnPtSkobg9JTzCcR4UgiQp/8/boztkoQEY60t5/SQwfY6RG7taZPRDiW1Qh9cv6s036nTUQ41ta90hPAZJZ+V3qC+SIiHGtn1x196RcPVZsuEeFEw19LTwDjebjrQtlpExFOZJcWffByP6X1O6WnmD8iwons0qJ29x+ntHrDKqQEEWEsmz+VngDed/eXlH5/I6XLX7lpaClnSg9AP2zday7mgtLyqjj/POYPNnv7padBRBhL/suaP/Vdu1J6EuZV/vnL8XDtUl1EhLHlT34iwjS93E9p4/vmDEGrjjqJCGPb2W0OYK5dLD0J8yAH5MI18aidA+tM5NaPpSdgXuQViIDUT0SYyPYjD6tiOlyf1A8iwsQ2vis9AVALEWFiO7vNmTLQJXfj7QcRISSvRl7aX02Hbn1WegLGISKE7O07yE63/nAppfWrpafgJCJC2ObQQXa69cMXHnlbOxHhVNbv2K1Ft4Y3U7pwrvQUHEVEOJWnz+3WoluLC56dXjMR4dQ2hyn9/KD0FMyytYt2a9VKRGjF+p3mqXLQFRGpk4jQir19x0folrv31klEaM3OrseT0o0//U1EaiUitGr4oPkLD23JP0/uo1UvEaF1+S+826LQBgGpn4jQifU7QsLp3H8sIH0gInRGSDgNx0D6QUTolJAQtTFIaWmh9BScRETonJAQsbiQ0vY3bglfOxFhKoSEiJVlIamdiDA1QkLEaEVi11adRISpEhIickhWPyw9BYcREaZOSJjUsxcp7TwpPQWHERGKEBLG9XI/pcHt5v5s1EdEKCaH5Nth6SmoWQ7I5a+a+7JRJxGhqI3vU/rv70tPQa0EpH4iQnGbQ7u2eN/PDwSkD0SEKjhGwrsEpB9EhGoICfSPiFCVje88ZpfGhXOlJ2AcIkJV9t6cjeMxuwwulZ6AcYgI1ckhGfyl9BSUtrggJH0gIlRp+1FKt/9ZegpK2/i09AScRESo1q0fHR+Zd2sXHRupnYhQtfU7pSegtFuflZ6A44gIVdvZdWuUeXftitVIzUSE6t360dla825jUHoCjiIiVG9vP6Wte6WnoKT1q6Un4CgiQi9s2qU11xYXhKRWIkIvPH2e0v3HpaegJNeM1ElE6A27tObb5Y9KT8BhRITe2H5UegJKWlwoPQGHERF64+lzFx9CbUSEXvGMCaiLiNArdmnNL6vQOokIvfL0eekJKMVp3nUSEXrFSmQ+5VWIs/PqJCL0jlugzJf839uNOOslIvSOg+vz4+WbJ136b14vEQGqJCD9ICJAde4/Tmn1hoD0gYjQOw6uz668+vjT35oViDPx+uFM6QEAnr1ozr7a/Km59T/9ISJAMT8/aOIxfFB6EqJEhN7xqNT+uv84pZ0nzS5J4ZgNIkLviEj9ciyePm++cjBGv2b2iAhwKs9eNKHIX3mV4Yyq+SIi9M6S50oU9XL/7e6o0SqD+SUi9M7KcukJ5tP9x81BcPew4iARoVccDynj0784EM7hXGxIr4jI9D17ISAcTUTolcsflZ5g/jjmwXFEhF5xUH363GaG44gIvbL6YekJgINEhF5ZdWbW1O08KT0BNRMReuPCuZQW7c6aOjdE5DgiQm9YhUB9RITecDwE6iMi9IbTe6E+IkJvrF0sPQHwLhGhF6xCoE4iQi+ISDluNcNxRIReEJFyRITjiAjVW1pwPKQkp1ZzHBGheoOPS08w35xazXFEhOoNLpWeYL6dP2uXFkcTEaq2tJDSH0SkOMekOIqIULX1q6UnIFkNcgwRoWobn5aegCyvBj3LhcOICNXKq5DzZ0tPwYigcxgRoVobg9ITcJBdixxGRKjWiusTqpJXhcLOu0SEaj17UXoC3uWaHd4lIlRrcFtIarP3qvQE1EZEqNbObkoXrqX0+xspfTtM6eFu6Ynm291fUlq/U3oKanOm9ABwkhyTje+bX18411yzsH7VMZOu5WhvP3r75VnrHOaD9Mnr7ZTSWulBYFJLC80++ssfNV9OBz4d0SDgtogwM1aXm5isfigqJ3m534Ri5004dp6IBiG37c5iZuQ3xJ0Dx00unGvCMopK/vXiHF51/exFE4n///fz5vvT56WnYlaICDMrv1Hmr+GDt7+Xw5K/clRGv56VZ5U8fBOHUSTyV15lQJdEhLly1Jvr0kKzYnn3e1ZDZF7uv11ljXY9vfsdShARSM2b8CgsB1cuBx0MSzqwqnnXUb9/0FFv/Ad/f+/Vb3fPQY1EBMZ0MDRAw8WGAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJAmIgAECYiAISJCABhIgJA2JmU0lZKabv0IAD0zvb/BQAA//9ANZDrpzIJMAAAAABJRU5ErkJggg\u003d\u003d"
  },
  "description": "웹 페이지에서 JavaScript SDK를 배포하고, JavaScript API를 활용하기 위한 템플릿입니다.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "SELECT",
    "name": "tagType",
    "displayName": "태그 타입",
    "selectItems": [
      {
        "value": "init",
        "displayValue": "🚀 초기화 (init)"
      },
      {
        "value": "track",
        "displayValue": "📊 기본 이벤트 전송 (track)"
      },
      {
        "value": "pageview",
        "displayValue": "📄 페이지뷰 이벤트 (pageview)"
      },
      {
        "value": "trackFirst",
        "displayValue": "📊 최초 이벤트 (trackFirst)"
      },
      {
        "value": "trackUpdate",
        "displayValue": "📊 갱신 이벤트 (trackUpdate)"
      },
      {
        "value": "trackOverwrite",
        "displayValue": "📊 덮어쓰기 이벤트 (trackOverwrite)"
      },
      {
        "value": "timeEvent",
        "displayValue": "📊 이벤트 시간측정 (timeEvent)"
      },
      {
        "value": "login",
        "displayValue": "👤 로그인 (login)"
      },
      {
        "value": "logout",
        "displayValue": "👤 로그아웃 (logout)"
      },
      {
        "value": "setDistinctId",
        "displayValue": "👤 게스트 ID 설정 (setDistinctId)"
      },
      {
        "value": "userSet",
        "displayValue": "⚙️ 사용자 속성 설정 (userSet)"
      },
      {
        "value": "userSetOnce",
        "displayValue": "⚙️ 사용자 속성 일회 설정 (userSetOnce)"
      },
      {
        "value": "userAdd",
        "displayValue": "⚙️ 사용자 속성 증가 (userAdd)"
      },
      {
        "value": "userUnset",
        "displayValue": "⚙️ 사용자 속성 값 삭제 (userUnset)"
      },
      {
        "value": "userDel",
        "displayValue": "⚙️ 사용자 속성 삭제 (userDel)"
      },
      {
        "value": "userDelete",
        "displayValue": "⚙️ 모든 사용자 속성 삭제 (userDelete)"
      },
      {
        "value": "userAppend",
        "displayValue": "⚙️ 사용자 속성 배열에 값 추가 (userAppend)"
      },
      {
        "value": "userUniqAppend",
        "displayValue": "⚙️ 사용자 속성 배열에 중복없이 값 추가 (userUniqAppend)"
      },
      {
        "value": "setSuperProperties",
        "displayValue": "🌍 공통 속성 설정 (setSuperProperties)"
      },
      {
        "value": "unsetSuperProperties",
        "displayValue": "🌍 공통 속성 해제 (unsetSuperProperties)"
      },
      {
        "value": "clearSuperProperties",
        "displayValue": "🌍 공통 속성 전체삭제 (clearSuperProperties)"
      },
      {
        "value": "setPageProperty",
        "displayValue": "🌍 페이지 공통 속성 설정 (setPageProperty)"
      }
    ],
    "simpleValueType": true,
    "defaultValue": "init",
    "alwaysInSummary": true
  },
  {
    "type": "GROUP",
    "name": "initGroup",
    "displayName": "🚀 SDK 초기화 설정",
    "groupStyle": "ZIPPY_OPEN",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "init",
        "type": "EQUALS"
      }
    ],
    "subParams": [
      {
        "type": "TEXT",
        "name": "appId",
        "displayName": "📋 App ID (필수)",
        "simpleValueType": true,
        "help": "💡 Thinking Engine 프로젝트 관리에서 확인할 수 있는 프로젝트 고유 ID입니다. \u003cbr\u003e📍 위치: 오른쪽 상단에 톱니바퀴 아이콘 -\u003e 프로젝트 관리 -\u003e 구성",
        "valueValidators": [
          {
            "type": "NON_EMPTY",
            "errorMessage": "❌ App ID는 필수 입력 항목입니다. Thinking Engine 대시보드에서 확인하세요."
          },
          {
            "type": "REGEX",
            "args": [
              "^[a-zA-Z0-9_-]+$"
            ],
            "errorMessage": "❌ App ID는 영문자, 숫자, 언더스코어(_), 하이픈(-)만 사용 가능합니다."
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "serverUrl",
        "displayName": "🌐 데이터 수집 서버 URL (필수)",
        "simpleValueType": true,
        "help": "📡 이벤트 데이터를 전송할 서버 엔드포인트입니다. \u003cbr\u003e⚠️ 기본값을 변경하지 않는 것을 권장합니다.",
        "defaultValue": "https://te-receiver-naver.thinkingdata.kr/sync_js",
        "valueValidators": [
          {
            "type": "NON_EMPTY",
            "errorMessage": "❌ 서버 URL은 필수 입력 항목입니다."
          },
          {
            "type": "REGEX",
            "args": [
              "^https?://.*"
            ],
            "errorMessage": "❌ 올바른 URL 형식이 아닙니다. http:// 또는 https://로 시작해야 합니다."
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "sdkUrl",
        "displayName": "📦 SDK CDN URL (선택사항)",
        "simpleValueType": true,
        "defaultValue": "https://cdn.jsdelivr.net/npm/thinkingdata-browser",
        "help": "🔧 자체 호스팅 SDK를 사용하거나 다른 CDN을 사용할 경우에만 변경하세요. \u003cbr\u003e💡 대부분의 경우 기본값을 유지하세요.",
        "valueValidators": [
          {
            "type": "REGEX",
            "args": [
              "^https?://.*|^$"
            ],
            "errorMessage": "❌ 올바른 URL 형식이 아닙니다. http:// 또는 https://로 시작하거나 공백으로 두세요."
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "instanceName",
        "displayName": "🏷️ SDK 인스턴스 이름",
        "simpleValueType": true,
        "help": "📝 JavaScript에서 SDK에 접근할 때 사용할 전역 변수명입니다. \u003cbr\u003e💡 예시: \u0027ta\u0027로 설정하면 ta.track() 형태로 사용 가능",
        "defaultValue": "ta",
        "valueValidators": [
          {
            "type": "REGEX",
            "args": [
              "^[a-zA-Z_$][a-zA-Z0-9_$]*$"
            ],
            "errorMessage": "❌ 올바른 JavaScript 변수명이 아닙니다. 영문자로 시작하고 영문자, 숫자, 언더스코어만 사용 가능합니다."
          }
        ]
      },
      {
        "type": "GROUP",
        "name": "autoTrackGroup",
        "displayName": "🤖 자동 수집 설정",
        "groupStyle": "ZIPPY_CLOSED",
        "subParams": [
          {
            "type": "CHECKBOX",
            "name": "enablePageShowHide",
            "checkboxText": "📱 페이지 표시/숨김 이벤트 자동 수집",
            "simpleValueType": true,
            "defaultValue": true,
            "help": "🎯 사용자가 페이지를 떠나고 돌아올 때를 자동으로 추적합니다. \u003cbr\u003e📊 수집되는 이벤트: ta_page_show, ta_page_hide \u003cbr\u003e💡 권장: 대부분의 경우 활성화하여 사용자 행동 패턴을 파악하세요"
          }
        ]
      },
      {
        "type": "GROUP",
        "name": "debugGroup",
        "displayName": "🔍 디버그 설정",
        "groupStyle": "ZIPPY_CLOSED",
        "subParams": [
          {
            "type": "CHECKBOX",
            "name": "enableSdkLogging",
            "checkboxText": "🐛 SDK 디버그 로그 활성화",
            "simpleValueType": true,
            "help": "⚠️ 개발 환경에서만 활성화하세요. \u003cbr\u003e📝 브라우저 콘솔에서 SDK 동작 상태를 확인할 수 있습니다.",
            "defaultValue": false
          }
        ]
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "instanceNameOther",
    "displayName": "🏷️ SDK 인스턴스 이름 (중요)",
    "simpleValueType": true,
    "help": "⚠️ 반드시 초기화 태그에서 설정한 인스턴스 이름과 동일해야 합니다! \u003cbr\u003e💡 예시: 초기화에서 \u0027ta\u0027로 설정했다면 여기도 \u0027ta\u0027로 입력",
    "defaultValue": "ta",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "init",
        "type": "NOT_EQUALS"
      }
    ],
    "valueValidators": [
      {
        "type": "REGEX",
        "args": [
          "^[a-zA-Z_$][a-zA-Z0-9_$]*$"
        ],
        "errorMessage": "❌ 올바른 JavaScript 변수명이 아닙니다. 영문자로 시작하고 영문자, 숫자, 언더스코어만 사용 가능합니다."
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "trackGroup",
    "displayName": "📊 기본 이벤트 전송 설정",
    "groupStyle": "ZIPPY_OPEN",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "track",
        "type": "EQUALS"
      }
    ],
    "subParams": [
      {
        "type": "TEXT",
        "name": "trackEventName",
        "displayName": "🏷️ 이벤트 이름 (필수)",
        "simpleValueType": true,
        "help": "📝 사용자 행동을 나타내는 이벤트 이름입니다. \u003cbr\u003e💡 예시: button_click, page_view, purchase_complete \u003cbr\u003e⚙️ 규칙: 영문자로 시작, 숫자/영문자/언더스코어(_)만 사용, 최대 50자",
        "valueValidators": [
          {
            "type": "NON_EMPTY",
            "errorMessage": "❌ 이벤트 이름은 필수 입력 항목입니다."
          },
          {
            "type": "REGEX",
            "args": [
              "^[a-zA-Z][a-zA-Z0-9_]*$"
            ],
            "errorMessage": "❌ 이벤트 이름은 영문자로 시작하고 영문자, 숫자, 언더스코어(_)만 사용 가능합니다."
          },
          {
            "type": "STRING_LENGTH",
            "args": [
              1,
              50
            ],
            "errorMessage": "❌ 이벤트 이름은 1-50자 사이여야 합니다."
          }
        ]
      },
      {
        "type": "SIMPLE_TABLE",
        "name": "trackEventProperties",
        "displayName": "🔧 이벤트 속성 (선택사항)",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "🏷️ 속성 이름",
            "name": "name",
            "type": "TEXT",
            "isUnique": true,
            "valueHint": "product_id, user_level, category 등"
          },
          {
            "defaultValue": "",
            "displayName": "💼 속성 값",
            "name": "value",
            "type": "TEXT",
            "valueHint": "{{product_id}}, premium, electronics 등"
          }
        ],
        "help": "📊 이벤트와 함께 전송할 추가 정보들입니다. \u003cbr\u003e💡 GTM 변수 사용 가능: {{variable_name}} 형태로 입력",
        "newRowButtonText": "➕ 속성 추가"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "pageviewGroup",
    "displayName": "📄 페이지뷰 이벤트 설정",
    "groupStyle": "ZIPPY_OPEN",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "pageview",
        "type": "EQUALS"
      }
    ],
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "pageviewProperties",
        "displayName": "📊 페이지뷰 속성 (선택사항)",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "🏷️ 속성 이름",
            "name": "name",
            "type": "TEXT",
            "isUnique": true,
            "valueHint": "page_title, page_category, content_type 등"
          },
          {
            "defaultValue": "",
            "displayName": "💼 속성 값",
            "name": "value",
            "type": "TEXT",
            "valueHint": "{{Page Title}}, product, article 등"
          }
        ],
        "help": "📄 페이지뷰 이벤트와 함께 전송할 페이지 관련 정보들입니다. <br>💡 자동 포함되는 속성: 페이지 URL, 페이지 제목, 리퍼러 등 <br>🎯 추가 예시: 페이지 카테고리, 콘텐츠 유형, 작성자 등",
        "newRowButtonText": "➕ 페이지뷰 속성 추가"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "loginGroup",
    "displayName": "🔐 사용자 로그인 설정",
    "groupStyle": "ZIPPY_OPEN",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "login",
        "type": "EQUALS"
      }
    ],
    "subParams": [
      {
        "type": "TEXT",
        "name": "accountId",
        "displayName": "👤 사용자 계정 ID (필수)",
        "simpleValueType": true,
        "help": "🔑 로그인한 사용자의 고유 식별자입니다. \u003cbr\u003e💡 예시: user123, john.doe@company.com, {{user_id}} \u003cbr\u003e⚠️ 개인정보가 포함되지 않도록 주의하세요.",
        "valueValidators": [
          {
            "type": "NON_EMPTY",
            "errorMessage": "❌ 계정 ID는 필수 입력 항목입니다. 로그인 사용자를 식별할 고유 ID를 입력하세요."
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "userSetGroup",
    "displayName": "⚙️ 사용자 속성 설정",
    "groupStyle": "ZIPPY_OPEN",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "userSet",
        "type": "EQUALS"
      },
      {
        "paramName": "tagType",
        "paramValue": "userSetOnce",
        "type": "EQUALS"
      }
    ],
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "setUserProperties",
        "displayName": "👤 사용자 속성 목록 (필수)",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "🏷️ 속성 이름",
            "name": "name",
            "type": "TEXT",
            "isUnique": true,
            "valueHint": "age, membership_level, city 등"
          },
          {
            "defaultValue": "",
            "displayName": "📝 속성 값",
            "name": "value",
            "type": "TEXT",
            "valueHint": "25, premium, {{user_city}} 등"
          }
        ],
        "help": "👥 로그인한 사용자에게 설정할 속성들입니다. \u003cbr\u003e💡 userSet: 매번 값을 덮어씌웁니다 / userSetOnce: 최초 1회만 설정됩니다 \u003cbr\u003e🔍 예시: 나이, 회원등급, 거주지역 등 사용자 특성 정보",
        "newRowButtonText": "➕ 사용자 속성 추가",
        "valueValidators": [
          {
            "type": "NON_EMPTY",
            "errorMessage": "❌ 최소 하나의 사용자 속성을 추가해주세요."
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "userAddGroup",
    "displayName": "📈 사용자 속성 숫자 증가",
    "groupStyle": "ZIPPY_OPEN",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "userAdd",
        "type": "EQUALS"
      }
    ],
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "userAddProperties",
        "displayName": "🔢 증가할 숫자 속성 (필수)",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "🏷️ 속성 이름",
            "name": "name",
            "type": "TEXT",
            "isUnique": true,
            "valueHint": "login_count, points, purchase_amount 등"
          },
          {
            "defaultValue": "",
            "displayName": "➕ 증가할 숫자",
            "name": "value",
            "type": "TEXT",
            "valueHint": "1, 100, {{reward_points}} 등",
            "valueValidators": [
              {
                "type": "NUMBER",
                "errorMessage": "❌ 숫자만 입력 가능합니다. 예: 1, -5, 100.5"
              }
            ]
          }
        ],
        "help": "🧮 기존 숫자 값에 지정된 숫자를 더합니다. \u003cbr\u003e💡 예시: 로그인 횟수 +1, 적립금 +100포인트 \u003cbr\u003e⚠️ 주의: 사용자 속성이 숫자 타입이어야 합니다",
        "newRowButtonText": "➕ 증가 속성 추가",
        "valueValidators": [
          {
            "type": "NON_EMPTY",
            "errorMessage": "❌ 최소 하나의 증가 속성을 설정해주세요."
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "userDelGroup",
    "displayName": "사용자 속성 삭제",
    "groupStyle": "ZIPPY_OPEN",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "userDel",
        "type": "EQUALS"
      }
    ],
    "subParams": [
      {
        "type": "TEXT",
        "name": "deleteProperties",
        "displayName": "📝 삭제할 속성 목록 (필수)",
        "simpleValueType": true,
        "help": "⚠️ 영구적으로 삭제할 사용자 속성들을 쉼표(,)로 구분하여 입력하세요. \u003cbr\u003e💡 예시: temp_data,old_preference,cached_info \u003cbr\u003e📊 사용 사례: 임시 데이터, 더 이상 사용하지 않는 속성 정리",
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "superPropertiesGroup",
    "displayName": "🌍 전역 공통 속성 설정",
    "groupStyle": "ZIPPY_OPEN",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "setSuperProperties",
        "type": "EQUALS"
      }
    ],
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "superProperties",
        "displayName": "🌐 전역 공통 속성 (필수)",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "🏷️ 속성 이름",
            "name": "name",
            "type": "TEXT",
            "isUnique": true,
            "valueHint": "app_version, platform, environment 등"
          },
          {
            "defaultValue": "",
            "displayName": "💼 속성 값",
            "name": "value",
            "type": "TEXT",
            "valueHint": "1.2.0, web, production 등"
          }
        ],
        "help": "🎯 모든 이벤트에 자동으로 포함될 공통 속성들입니다. \u003cbr\u003e💡 예시: 앱 버전, 플랫폼 정보, 환경 설정 등 \u003cbr\u003e⚠️ 주의: 한 번 설정하면 이후 모든 이벤트에 자동 포함됩니다",
        "newRowButtonText": "➕ 공통 속성 추가",
        "valueValidators": [
          {
            "type": "NON_EMPTY",
            "errorMessage": "❌ 최소 하나의 공통 속성을 설정해주세요."
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "unsetSuperPropertiesGroup",
    "displayName": "공통 속성 해제",
    "groupStyle": "ZIPPY_OPEN",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "unsetSuperProperties",
        "type": "EQUALS"
      }
    ],
    "subParams": [
      {
        "type": "TEXT",
        "name": "unsetSuperProperties",
        "displayName": "해제할 공통 속성들",
        "simpleValueType": true,
        "help": "해제할 공통 속성 이름들을 쉼표로 구분한 목록",
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "timeEventGroup",
    "displayName": "⏱️ 이벤트 시간 측정 시작",
    "groupStyle": "ZIPPY_OPEN",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "timeEvent",
        "type": "EQUALS"
      }
    ],
    "subParams": [
      {
        "type": "TEXT",
        "name": "timeEventName",
        "displayName": "📄 시간 측정할 이벤트 이름 (필수)",
        "simpleValueType": true,
        "help": "🕰️ 시간 측정을 시작할 이벤트 이름입니다. \u003cbr\u003e💡 예시: video_play, form_start, page_load \u003cbr\u003e🔍 동작: 이후 동일한 이벤트 전송 시 소요 시간이 자동으로 포함됩니다 \u003cbr\u003e🎯 사용 사례: 비디오 시청 시간, 폼 작성 시간, 상품 조회 시간 등",
        "valueValidators": [
          {
            "type": "NON_EMPTY",
            "errorMessage": "❌ 시간 측정을 시작할 이벤트 이름을 입력해주세요."
          },
          {
            "type": "REGEX",
            "args": [
              "^[a-zA-Z][a-zA-Z0-9_]*$"
            ],
            "errorMessage": "❌ 이벤트 이름은 영문자로 시작하고 영문자, 숫자, 언더스코어(_)만 사용 가능합니다."
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "trackFirstGroup",
    "displayName": "🎆 최초 이벤트 설정",
    "groupStyle": "ZIPPY_OPEN",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "trackFirst",
        "type": "EQUALS"
      }
    ],
    "subParams": [
      {
        "type": "TEXT",
        "name": "firstEventName",
        "displayName": "🏷️ 최초 이벤트 이름 (필수)",
        "simpleValueType": true,
        "help": "🎯 사용자가 최초로 수행하는지 확인할 이벤트입니다. \u003cbr\u003e💡 예시: first_purchase, app_install, first_login \u003cbr\u003e🔍 동작: 이미 발생한 이벤트는 중복 전송되지 않습니다",
        "valueValidators": [
          {
            "type": "NON_EMPTY",
            "errorMessage": "❌ 최초 이벤트 이름을 입력해주세요."
          },
          {
            "type": "REGEX",
            "args": [
              "^[a-zA-Z][a-zA-Z0-9_]*$"
            ],
            "errorMessage": "❌ 이벤트 이름은 영문자로 시작하고 영문자, 숫자, 언더스코어(_)만 사용 가능합니다."
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "firstCheckId",
        "displayName": "🔑 최초 확인 ID (선택사항)",
        "simpleValueType": true,
        "help": "👤 최초 이벤트 발생 여부를 판단할 기준 ID입니다. \u003cbr\u003e💡 미입력 시: 디바이스 ID 기준으로 판단 \u003cbr\u003e📝 입력 시: 해당 사용자 ID 기준으로 판단"
      },
      {
        "type": "SIMPLE_TABLE",
        "name": "firstEventProperties",
        "displayName": "🔧 최초 이벤트 속성 (선택사항)",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "🏷️ 속성 이름",
            "name": "name",
            "type": "TEXT",
            "isUnique": true,
            "valueHint": "install_source, referrer, campaign 등"
          },
          {
            "defaultValue": "",
            "displayName": "💼 속성 값",
            "name": "value",
            "type": "TEXT",
            "valueHint": "google_play, {{utm_source}}, summer_2024 등"
          }
        ],
        "help": "🎆 최초 이벤트와 함께 전송할 속성들입니다. \u003cbr\u003e💡 예시: 설치 경로, 마케팅 캠페인, 추천인 정보 등",
        "newRowButtonText": "➕ 속성 추가"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "trackUpdateGroup",
    "displayName": "갱신 이벤트 설정",
    "groupStyle": "ZIPPY_OPEN",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "trackUpdate",
        "type": "EQUALS"
      }
    ],
    "subParams": [
      {
        "type": "TEXT",
        "name": "updateEventName",
        "displayName": "이벤트 이름",
        "simpleValueType": true,
        "help": "갱신할 이벤트 이름",
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "updateEventId",
        "displayName": "이벤트 ID",
        "simpleValueType": true,
        "help": "갱신할 이벤트를 식별하는 고유 ID",
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "SIMPLE_TABLE",
        "name": "updateEventProperties",
        "displayName": "이벤트 속성",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "속성 이름",
            "name": "name",
            "type": "TEXT",
            "isUnique": true
          },
          {
            "defaultValue": "",
            "displayName": "속성 값",
            "name": "value",
            "type": "TEXT"
          }
        ],
        "help": "갱신할 속성들입니다.",
        "newRowButtonText": "속성 추가"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "trackOverwriteGroup",
    "displayName": "덮어쓰기 이벤트 설정",
    "groupStyle": "ZIPPY_OPEN",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "trackOverwrite",
        "type": "EQUALS"
      }
    ],
    "subParams": [
      {
        "type": "TEXT",
        "name": "overwriteEventName",
        "displayName": "이벤트 이름",
        "simpleValueType": true,
        "help": "덮어쓸 이벤트 이름",
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "overwriteEventId",
        "displayName": "이벤트 ID",
        "simpleValueType": true,
        "help": "덮어쓸 이벤트를 식별하는 고유 ID",
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "SIMPLE_TABLE",
        "name": "overwriteEventProperties",
        "displayName": "이벤트 속성",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "속성 이름",
            "name": "name",
            "type": "TEXT",
            "isUnique": true
          },
          {
            "defaultValue": "",
            "displayName": "속성 값",
            "name": "value",
            "type": "TEXT"
          }
        ],
        "help": "완전히 교체할 속성들입니다.",
        "newRowButtonText": "속성 추가"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "setDistinctIdGroup",
    "displayName": "🔑 비로그인 사용자 ID 설정",
    "groupStyle": "ZIPPY_OPEN",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "setDistinctId",
        "type": "EQUALS"
      }
    ],
    "subParams": [
      {
        "type": "TEXT",
        "name": "distinctId",
        "displayName": "👥 비로그인 사용자 고유 ID (필수)",
        "simpleValueType": true,
        "help": "🔍 로그인하지 않은 사용자를 식별하기 위한 고유 ID입니다. \u003cbr\u003e💡 예시: guest_12345, temp_user_abc, {{anonymous_id}} \u003cbr\u003e⚠️ 주의: 로그인 후에는 login 이벤트로 계정 ID를 설정하세요 \u003cbr\u003e🔄 사용 사례: 일시적 비로그인 상태 사용자 추적",
        "valueValidators": [
          {
            "type": "NON_EMPTY",
            "errorMessage": "❌ 비로그인 사용자 ID를 입력해주세요. 예: guest_12345, {{anonymous_id}}"
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "userUnsetGroup",
    "displayName": "사용자 속성 값 삭제",
    "groupStyle": "ZIPPY_OPEN",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "userUnset",
        "type": "EQUALS"
      }
    ],
    "subParams": [
      {
        "type": "TEXT",
        "name": "propertyName",
        "displayName": "삭제할 속성 이름",
        "simpleValueType": true,
        "help": "값을 삭제(NULL로 설정)할 속성 이름",
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "userAppendGroup",
    "displayName": "사용자 속성 배열에 값 추가",
    "groupStyle": "ZIPPY_OPEN",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "userAppend",
        "type": "EQUALS"
      },
      {
        "paramName": "tagType",
        "paramValue": "userUniqAppend",
        "type": "EQUALS"
      }
    ],
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "appendUserProperties",
        "displayName": "사용자 속성",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "속성 이름",
            "name": "name",
            "type": "TEXT",
            "isUnique": true
          },
          {
            "defaultValue": "",
            "displayName": "속성 값 (배열)",
            "name": "value",
            "type": "TEXT"
          }
        ],
        "help": "배열에 추가할 값들입니다. 배열 형태로 입력하세요. 예: [\"apple\", \"banana\"]",
        "newRowButtonText": "속성 추가",
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "setPagePropertyGroup",
    "displayName": "📱 페이지별 공통 속성 설정",
    "groupStyle": "ZIPPY_OPEN",
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "setPageProperty",
        "type": "EQUALS"
      }
    ],
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "pageProperties",
        "displayName": "📜 페이지 공통 속성 (필수)",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "🏷️ 속성 이름",
            "name": "name",
            "type": "TEXT",
            "isUnique": true,
            "valueHint": "page_category, content_type, section 등"
          },
          {
            "defaultValue": "",
            "displayName": "💼 속성 값",
            "name": "value",
            "type": "TEXT",
            "valueHint": "product, article, {{page_title}} 등"
          }
        ],
        "help": "📄 현재 페이지에서 발생하는 모든 이벤트에 자동으로 포함될 속성들입니다. \u003cbr\u003e💡 예시: 페이지 카테고리, 콘텐트 유형, 섹션 정보 등 \u003cbr\u003e⚠️ 주의: 전역 공통 속성과 달리 해당 페이지에서만 적용됩니다 \u003cbr\u003e🎯 사용 사례: 상품 상세페이지, 블로그 글, 랜딩페이지 등의 컴텍스트 정보",
        "newRowButtonText": "➕ 페이지 속성 추가",
        "valueValidators": [
          {
            "type": "NON_EMPTY",
            "errorMessage": "❌ 최소 하나의 페이지 속성을 설정해주세요."
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "globalSettingsGroup",
    "displayName": "⚙️ 전역 설정",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "CHECKBOX",
        "name": "enableLogging",
        "checkboxText": "🐛 태그 디버그 로그 활성화",
        "simpleValueType": true,
        "help": "🔍 개발 환경에서 태그 실행 상태를 확인할 때 사용하세요. \u003cbr\u003e⚠️ 운영 환경에서는 비활성화하는 것을 권장합니다. \u003cbr\u003e📝 브라우저 개발자 도구 콘솔에서 확인 가능",
        "defaultValue": false
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

/**
 * Thinking Engine GTM 템플릿
 * 
 * 이 템플릿은 Thinking Engine JavaScript SDK의 모든 기능을 하나의 태그에서 제공합니다.
 * 
 * 지원 기능:
 * - SDK 초기화 (init)
 * - 기본 이벤트 전송 (track, login, logout)
 * - 사용자 속성 관리 (userSet, userSetOnce, userAdd, userUnset, userDelete, userAppend, userUniqAppend)
 * - 공통 속성 설정 (setSuperProperties, setPageProperty)
 * - 고급 이벤트 API (trackFirst, trackUpdate, trackOverwrite, timeEvent)
 * - 사용자 식별 (setDistinctId)
 * 
 * @version 1.0
 * @author Thinking Engine Team
 * @enhanced GTM template compatible (no Array object access)
 */

/**
 * Thinking Engine GTM 템플릿 - 권한 문제 해결 버전
 * @version 1.0
 * @enhanced Removed eval usage to avoid permission issues
 */

// =============================================================================
// GTM API 임포트
// =============================================================================
const injectScript = require('injectScript');
const callInWindow = require('callInWindow');
const logToConsole = require('logToConsole');
const copyFromWindow = require('copyFromWindow');
const setInWindow = require('setInWindow');
const makeNumber = require('makeNumber');
const templateStorage = require('templateStorage');
const getUrl = require('getUrl');
const readTitle = require('readTitle');
const getReferrerUrl = require('getReferrerUrl');
const copyFromDataLayer = require('copyFromDataLayer');

// =============================================================================
// 상수 정의
// =============================================================================
const SDK_URL_DEFAULT = 'https://cdn.jsdelivr.net/npm/thinkingdata-browser';
const SERVER_URL_DEFAULT = 'https://te-receiver-naver.thinkingdata.kr/sync_js';
const INSTANCE_NAME_DEFAULT = 'ta';
const LOG_PREFIX = '[TE All-in-One] ';
const STORAGE_PREFIX = 'te_';
const INSTANCES_STORAGE_KEY = STORAGE_PREFIX + 'instances';

// =============================================================================
// 헬퍼 함수들
// =============================================================================
const enableLogging = data.enableLogging;

function log(message, optionalData) {
  if (enableLogging) {
    if (optionalData !== undefined) {
      logToConsole(LOG_PREFIX + message, optionalData);
    } else {
      logToConsole(LOG_PREFIX + message);
    }
  }
}

function fail(message) {
  log('Error: ' + message);
  data.gtmOnFailure();
  return;
}

function success(message) {
  if (message) {
    log('Success: ' + message);
  }
  data.gtmOnSuccess();
}

log('Starting execution with tag type: ' + data.tagType);

// =============================================================================
// 데이터 정규화 및 변환 함수들
// =============================================================================

function normalize(value) {
  if (value === null || value === undefined) {
    return value;
  }
  
  if (value === 'null') return null;
  if (value === 'undefined') return undefined;
  if (value === 'true' || value === true) return true;
  if (value === 'false' || value === false) return false;
  if (value === '') return '';
  
  const numValue = makeNumber(value);
  if (numValue !== null && numValue !== undefined && numValue === numValue) {
    return numValue;
  }
  
  return value;
}

function normalizeTable(table) {
  if (!table || table.length === 0) {
    return {};
  }
  
  const result = {};
  let i = 0;
  while (i < table.length) {
    const row = table[i];
    if (row && row.name && row.value !== undefined) {
      result[row.name] = normalize(row.value);
    }
    i++;
  }
  
  return result;
}

function hasValidProperties(obj) {
  if (!obj || typeof obj !== 'object') {
    return false;
  }
  
  // normalizeTable 결과를 확인하는 간단한 방법
  // obj가 빈 객체가 아니라면 속성이 있다고 가정
  return obj !== null && typeof obj === 'object';
}

function convertPropertiesToObject(propertiesTable) {
  return normalizeTable(propertiesTable);
}

function hasProperties(table) {
  // 테이블 배열 자체를 확인하는 것이 더 정확
  return table && table.length && table.length > 0;
}

// =============================================================================
// SDK 상태 확인 함수들 (eval 제거 버전)
// =============================================================================

/**
 * SDK 상태를 copyFromWindow만으로 확인 (eval 사용 안함)
 */
function checkSDKAvailability(instanceName) {
  log('Checking SDK availability for instance: ' + instanceName);
  
  // copyFromWindow로만 확인
  const directInstance = copyFromWindow(instanceName);
  const directGlobal = copyFromWindow('thinkingdata');
  
  log('Direct copyFromWindow check - instance:', !!directInstance);
  log('Direct copyFromWindow check - global:', !!directGlobal);
  
  // Window에서 SDK 상태 확인
  const sdkReady = copyFromWindow('te_sdk_ready');
  log('Window SDK ready status:', sdkReady);
  
  // 결과 종합
  if (directInstance || directGlobal) {
    return {
      available: true,
      method: 'direct',
      instance: directInstance,
      global: directGlobal
    };
  }
  
  // SDK가 준비되었다고 Window에 표시되어 있으면 재시도
  if (sdkReady === true) {
    return {
      available: true,
      method: 'window',
      instance: null,
      global: null
    };
  }
  
  return {
    available: false,
    method: 'none'
  };
}

/**
 * 인스턴스 생성 또는 확인 (eval 사용 안함)
 */
function ensureInstance(instanceName, sdkCheck) {
  if (sdkCheck.global) {
    log('Creating missing instance via direct method: ' + instanceName);
    callInWindow('thinkingdata.initInstance', instanceName);
    return true;
  }
  
  // Window 기반으로 재시도
  if (sdkCheck.method === 'window') {
    log('Attempting to create instance based on Window status');
    callInWindow('thinkingdata.initInstance', instanceName);
    return true;
  }
  
  return false;
}

// =============================================================================
// Thinking Engine 초기화 함수
// =============================================================================

function isInstanceInitialized(instanceName) {
  const initFlag = templateStorage.getItem(STORAGE_PREFIX + instanceName + '_init');
  return initFlag === 'true';
}

function markInstanceAsInitialized(instanceName) {
  templateStorage.setItem(STORAGE_PREFIX + instanceName + '_init', 'true');
}

function initializeTE() {
  const instanceName = data.instanceName || INSTANCE_NAME_DEFAULT;
  
  if (isInstanceInitialized(instanceName)) {
    log('Instance already initialized: ' + instanceName);
    success('Instance already initialized');
    return;
  }
  
  const sdkUrl = data.sdkUrl || SDK_URL_DEFAULT;
  log('Starting SDK injection from: ' + sdkUrl);

  injectScript(sdkUrl, function() {
    log('SDK loaded successfully');

    const config = {
      appId: data.appId,
      serverUrl: data.serverUrl || SERVER_URL_DEFAULT,
      autoTrack: {
        pageShow: !!data.enablePageShowHide,
        pageHide: !!data.enablePageShowHide
      },
      showLog: !!data.enableSdkLogging
    };

    callInWindow('thinkingdata.init', config);
    
    // 직접 인스턴스 생성 (thinkingdata.initInstance가 작동하지 않는 경우 대비)
    const tdInstance = copyFromWindow('thinkingdata');
    if (tdInstance) {
      log('Creating instance manually using thinkingdata object');
      callInWindow('thinkingdata.initInstance', instanceName);
      
      // 추가적으로 직접 바인딩 시도
      setInWindow(instanceName, tdInstance);
    } else {
      log('thinkingdata object not found, using initInstance method');
      callInWindow('thinkingdata.initInstance', instanceName);
    }
    
    log('SDK initialized and instance created: ' + instanceName);
    
    // Window에 SDK 준비 상태 설정 (GTM 호환)
    setInWindow('te_sdk_ready', true);
    setInWindow('te_instance_name', instanceName);
        

    markInstanceAsInitialized(instanceName);
    success('Initialization completed successfully');
    
  }, function() {
    fail('Failed to load SDK from: ' + sdkUrl);
  });
}

// =============================================================================
// 이벤트 전송 실행
// =============================================================================

function executeEventSending() {
  switch (data.tagType) {
    case 'track':
      if (!data.trackEventName) {
        return fail('Event name is required for track');
      }
      
      const eventProperties = convertPropertiesToObject(data.trackEventProperties);
      callTE2('track', data.trackEventName, eventProperties);
      break;
      
    case 'pageview':
      const pageviewProperties = convertPropertiesToObject(data.pageviewProperties) || {};
      callTE2('track', 'ta_pageview', pageviewProperties);
      break;
      
    case 'login':
      if (!data.accountId) {
        return fail('Account ID is required for login');
      }
      callTE1('login', data.accountId);
      break;
      
    case 'logout':
      callTE0('logout');
      break;
      
    case 'userSet':
      if (!hasProperties(data.setUserProperties)) {
        return fail('User properties are required for userSet');
      }
      const userSetProperties = convertPropertiesToObject(data.setUserProperties);
      callTE1('userSet', userSetProperties);
      break;
      
    case 'userSetOnce':
      if (!hasProperties(data.setUserProperties)) {
        return fail('User properties are required for userSetOnce');
      }
      const userSetOnceProperties = convertPropertiesToObject(data.setUserProperties);
      callTE1('userSetOnce', userSetOnceProperties);
      break;
      
    case 'userAdd':
      if (!hasProperties(data.userAddProperties)) {
        return fail('User properties are required for userAdd');
      }
      const userAddProperties = convertPropertiesToObject(data.userAddProperties);
      callTE1('userAdd', userAddProperties);
      break;
      
    case 'setSuperProperties':
      if (!hasProperties(data.superProperties)) {
        return fail('Super properties are required for setSuperProperties');
      }
      const superProperties = convertPropertiesToObject(data.superProperties);
      callTE1('setSuperProperties', superProperties);
      break;
      
    case 'userDel':
      if (!data.deleteProperties) {
        return fail('Delete properties are required for userDel');
      }
      const deleteProps = data.deleteProperties.split(',').map(function(item) {
        return item.trim();
      }).filter(function(item) {
        return item.length > 0;
      });
      callTE1('userDel', deleteProps);
      break;
      
    case 'unsetSuperProperties':
      if (!data.unsetSuperProperties) {
        return fail('Unset properties are required for unsetSuperProperties');
      }
      const unsetProps = data.unsetSuperProperties.split(',').map(function(item) {
        return item.trim();
      }).filter(function(item) {
        return item.length > 0;
      });
      callTE1('unsetSuperProperties', unsetProps);
      break;
      
    case 'clearSuperProperties':
      callTE0('clearSuperProperties');
      break;
      
    case 'timeEvent':
      if (!data.timeEventName) {
        return fail('Event name is required for timeEvent');
      }
      callTE1('timeEvent', data.timeEventName);
      break;
      
    case 'trackFirst':
      if (!data.firstEventName) {
        return fail('Event name is required for trackFirst');
      }
      
      const firstEventData = {
        eventName: data.firstEventName,
        properties: convertPropertiesToObject(data.firstEventProperties) || {}
      };
      
      if (data.firstCheckId) {
        firstEventData.firstCheckId = data.firstCheckId;
      }
      
      callTE1('trackFirst', firstEventData);
      break;
      
    case 'trackUpdate':
      if (!data.updateEventName || !data.updateEventId) {
        return fail('Event name and event ID are required for trackUpdate');
      }
      
      const updateEventData = {
        eventName: data.updateEventName,
        properties: convertPropertiesToObject(data.updateEventProperties) || {},
        eventId: data.updateEventId
      };
      
      callTE1('trackUpdate', updateEventData);
      break;
      
    case 'trackOverwrite':
      if (!data.overwriteEventName || !data.overwriteEventId) {
        return fail('Event name and event ID are required for trackOverwrite');
      }
      
      const overwriteEventData = {
        eventName: data.overwriteEventName,
        properties: convertPropertiesToObject(data.overwriteEventProperties) || {},
        eventId: data.overwriteEventId
      };
      
      callTE1('trackOverwrite', overwriteEventData);
      break;
      
    case 'timeEvent':
      if (!data.timeEventName) {
        return fail('Event name is required for timeEvent');
      }
      callTE1('timeEvent', data.timeEventName);
      break;
      
    case 'setDistinctId':
      if (!data.distinctId) {
        return fail('Distinct ID is required for setDistinctId');
      }
      callTE1('setDistinctId', data.distinctId);
      break;
      
    case 'userUnset':
      if (!data.propertyName) {
        return fail('Property name is required for userUnset');
      }
      callTE1('userUnset', data.propertyName);
      break;
      
    case 'userDelete':
      callTE0('userDelete');
      break;
      
    case 'userAppend':
      if (!hasProperties(data.appendUserProperties)) {
        return fail('User properties are required for userAppend');
      }
      const appendProperties = convertPropertiesToObject(data.appendUserProperties);
      callTE1('userAppend', appendProperties);
      break;
      
    case 'userUniqAppend':
      if (!hasProperties(data.appendUserProperties)) {
        return fail('User properties are required for userUniqAppend');
      }
      const uniqAppendProperties = convertPropertiesToObject(data.appendUserProperties);
      callTE1('userUniqAppend', uniqAppendProperties);
      break;
      
    case 'setPageProperty':
      if (!hasProperties(data.pageProperties)) {
        return fail('Page properties are required for setPageProperty');
      }
      const pageProperties = convertPropertiesToObject(data.pageProperties);
      callTE1('setPageProperty', pageProperties);
      break;
      
    default:
      return fail('Unknown tag type: ' + data.tagType);
  }
}

// =============================================================================
// Thinking Engine 인스턴스 호출 함수들
// =============================================================================

function callTE1(method, arg1) {
  const instanceName = data.instanceNameOther || INSTANCE_NAME_DEFAULT;
  
  // window.ta가 없으면 thinkingdata를 직접 사용
  const actualInstance = copyFromWindow(instanceName);
  if (actualInstance) {
    log('Calling ' + instanceName + '.' + method, arg1);
    callInWindow(instanceName + '.' + method, arg1);
    success('Successfully called ' + instanceName + '.' + method);
  } else {
    log('Instance not found, using thinkingdata.' + method + ' directly', arg1);
    callInWindow('thinkingdata.' + method, arg1);
    success('Successfully called thinkingdata.' + method);
  }
}

function callTE2(method, arg1, arg2) {
  const instanceName = data.instanceNameOther || INSTANCE_NAME_DEFAULT;
  
  const actualInstance = copyFromWindow(instanceName);
  if (actualInstance) {
    log('Calling ' + instanceName + '.' + method, {arg1: arg1, arg2: arg2});
    callInWindow(instanceName + '.' + method, arg1, arg2);
    success('Successfully called ' + instanceName + '.' + method);
  } else {
    log('Instance not found, using thinkingdata.' + method + ' directly', {arg1: arg1, arg2: arg2});
    callInWindow('thinkingdata.' + method, arg1, arg2);
    success('Successfully called thinkingdata.' + method);
  }
}

function callTE0(method) {
  const instanceName = data.instanceNameOther || INSTANCE_NAME_DEFAULT;
  
  const actualInstance = copyFromWindow(instanceName);
  if (actualInstance) {
    log('Calling ' + instanceName + '.' + method);
    callInWindow(instanceName + '.' + method);
    success('Successfully called ' + instanceName + '.' + method);
  } else {
    log('Instance not found, using thinkingdata.' + method + ' directly');
    callInWindow('thinkingdata.' + method);
    success('Successfully called thinkingdata.' + method);
  }
}

// =============================================================================
// 단순화된 인스턴스 확인 (setTimeout 및 callback 제거)
// =============================================================================

// =============================================================================
// 메인 실행 로직
// =============================================================================

if (data.tagType === 'init') {
  initializeTE();
} else {
  const instanceName = data.instanceNameOther || INSTANCE_NAME_DEFAULT;
  const sdkCheck = checkSDKAvailability(instanceName);
  
  if (sdkCheck.available) {
    if (sdkCheck.instance) {
      log('SDK instance available, proceeding with event');
      executeEventSending();
    } else if (sdkCheck.global) {
      log('Global SDK found, creating instance: ' + instanceName);
      
      if (ensureInstance(instanceName, sdkCheck)) {
        log('Instance creation attempted, proceeding with event');
        executeEventSending();
      } else {
        fail('Failed to create instance');
      }
    } else if (sdkCheck.method === 'window') {
      // Window 플래그가 true면 SDK가 준비된 것으로 간주하고 실행
      log('SDK ready flag detected, proceeding with event');
      executeEventSending();
    } else {
      fail('SDK not in expected state');
    }
  } else {
    fail('SDK not found. Please ensure initialization tag runs first.');
  }
}


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.init"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.initInstance"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.track"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.login"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.logout"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.userSet"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.userSetOnce"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.userAdd"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.setSuperProperties"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.quick"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.track"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.login"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.logout"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.userSet"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.userSetOnce"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.userAdd"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.setSuperProperties"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.quick"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.trackFirst"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.trackUpdate"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.trackOverwrite"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.timeEvent"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.setDistinctId"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.userUnset"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.userDelete"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.userAppend"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.userUniqAppend"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ta.setPageProperty"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "te_sdk_ready"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "te_instance_name"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.trackFirst"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.trackUpdate"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.trackOverwrite"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.setDistinctId"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.userUnset"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.userDelete"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.userAppend"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.userUniqAppend"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "thinkingdata.setPageProperty"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://cdn.jsdelivr.net/npm/thinkingdata-browser"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_template_storage",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_url",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_title",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_referrer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_data_layer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedKeys",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "keyPatterns",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "te_sdk_ready"
              },
              {
                "type": 1,
                "string": "te_instance_name"
              },
              {
                "type": 1,
                "string": "event"
              }
            ]
          }
        }
      ]
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 2025. 8. 20. 오후 7:45:12


